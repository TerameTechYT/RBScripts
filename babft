local Build = game.Players.LocalPlayer.Backpack.BuildingTool:FindFirstChild("RF");
local Paint = game.Players.LocalPlayer.Backpack.PaintingTool:FindFirstChild("RF");
local Scale = game.Players.LocalPlayer.Backpack.ScalingTool:FindFirstChild("RF");
local InsertService = game:GetService("InsertService")
local modelId = _G.modelId
local Model = game:GetObjects('rbxassetid://'..modelId)[1]
Model:MoveTo(Vector3.new(0,0,0))
local BlobOld = Vector3.new(-52.366, 63.225, -348.407)
local HighlightMode = _G.HighlightMode
local BlockToChoose = "WoodBlock"
local ScalePart

local MaterialList = {
	[Enum.Material.Asphalt] = "ConcreteBlock",
	[Enum.Material.Basalt] = "CoalBlock",
	[Enum.Material.Brick] = "BrickBlock",
	[Enum.Material.Cobblestone] = "StoneBlock",
	[Enum.Material.Concrete] = "ConcreteBlock",
	[Enum.Material.CorrodedMetal] = "RustedBlock",
	[Enum.Material.CrackedLava] = "ObsidianBlock",
	[Enum.Material.DiamondPlate] = "TitaniumBlock",
	[Enum.Material.Fabric] = "FabricBlock",
	[Enum.Material.Foil] = "BouncyBlock",
	[Enum.Material.ForceField] = "Glass",
	[Enum.Material.Glass] = "GoldBlock",
	[Enum.Material.Granite] = "ObsidianBlock",
	[Enum.Material.Grass] = "GrassBlock",
	[Enum.Material.Ground] = "CoalBlock",
	[Enum.Material.Ice] = "IceBlock",
	[Enum.Material.LeafyGrass] = "GrassBlock",
	[Enum.Material.Limestone] = "CoalBlock",
	[Enum.Material.Marble] = "MarbleBlock",
	[Enum.Material.Metal] = "MetalBlock",
	[Enum.Material.Mud] = "CoalBlock",
	[Enum.Material.Neon] = "NeonBlock",
	[Enum.Material.Pavement] = "ConcreteBlock",
	[Enum.Material.Pebble] = "StoneBlock",
	[Enum.Material.Plastic] = "PlasticBlock",
	[Enum.Material.Rock] = "CoalBlock",
	[Enum.Material.Salt] = "SandBlock",
	[Enum.Material.Sand] = "SandBlock",
	[Enum.Material.Sandstone] = "CoalBlock",
	[Enum.Material.Slate] = "CoalBlock",
	[Enum.Material.SmoothPlastic] = "PlasticBlock",
	[Enum.Material.Snow] = "SandBlock",
	[Enum.Material.Wood] = "SmoothWoodBlock",
	[Enum.Material.WoodPlanks] = "WoodBlock",

}

workspace.ChildAdded:Connect(function(child)
	if child:WaitForChild("Tag").Value == game.Players.LocalPlayer.Name then
		ScalePart = child
        print(ScalePart.PPart.CFrame)
	end
end)

if HighlightMode then
	for i = 1, #_G.size do
        wait()
        coroutine.wrap(function()
        	local whiteBase = CFrame.new(_G.position[i] + Vector3.new(0,5,0))
		    if _G.UseBlobsPos == true then
		    	whiteBase = CFrame.new(_G.position[i] + Vector3.new(1.2,81.2,-3)) 
		    end
		    BlockToChoose = MaterialList[_G.material[i]]
            print(BlockToChoose)
		    whiteBase *= CFrame.Angles(math.rad(_G.rotation[i].X), math.rad(_G.rotation[i].Y), math.rad(_G.rotation[i].Z))
            print(tostring(whiteBase))
		    Build:InvokeServer(BlockToChoose, game.Players.LocalPlayer.Data:FindFirstChild(BlockToChoose).Value, workspace.WhiteZone, whiteBase, true);
            coroutine.wrap(function()
                Scale:InvokeServer(ScalePart, _G.size[i], ScalePart.PPart.CFrame)
            end)()
            Paint:InvokeServer({{ScalePart, _G.color[i]}})
        end)()
	end
else
	for i,v in pairs(Model:GetDescendants()) do
		if v:IsA("Part") then
            wait()
            coroutine.wrap(function()
            	local whiteBase = CFrame.new(v.Position + Vector3.new(0,5,0))
			    if _G.UseBlobsPos == true then
				    whiteBase = CFrame.new(BlobOld + v.Position)
			    end
			    whiteBase *= CFrame.Angles(math.rad(v.Rotation.X), math.rad(v.Rotation.Y), math.rad(v.Rotation.Z))
			    BlockToChoose = MaterialList[v.Material]
			    Build:InvokeServer(BlockToChoose, game.Players.LocalPlayer.Data:FindFirstChild(BlockToChoose).Value, workspace.WhiteZone, whiteBase, true);
                coroutine.wrap(function()
                    Scale:InvokeServer(ScalePart, v.Size, ScalePart:FindFirstChild("PPart").CFrame)
                end)()
                Paint:InvokeServer({{ScalePart, v.Color}})
            end)()
		end
	end
end

Model:Destroy()
